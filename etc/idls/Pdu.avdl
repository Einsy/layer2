import idl "./Ethernet2.avdl";
import idl "./Radiotap.avdl";

protocol Pdu {

  // TODO: Edit CPP code generation tool to support namespaces.
  // TODO: Explore using an extend/include keyword to avoid repeating common
  // fields (e.g. 802.11 headers).

  /**
   * Outermost PDU.
   *
   */
  record Pdu {
    int size;
    @logicalType("timestamp-millis") long timestamp;
    union {
      Unsupported,
      Ethernet2,
      Radiotap
    } frame;
  }

}
